!function(){var t={name:"oojs",namespace:"",config:{global:!1,proxyName:"proxy",basePath:""},$oojs:function(){if(this.config="undefined"!=typeof $oojs_config?$oojs_config:this.config,"undefined"!=typeof window)this.global=this.config.global||window,this.runtime="browser",this.basePath=this.config.basePath;else if(global){var e=require("path");this.global=this.config.global||global,this.runtime="node",this.basePath=this.config.basePath?e.resolve(this.config.basePath):e.resolve(__dirname,"../../../src")+"/";var n=module.constructor,i=n.wrap;n.wrap=function(t){return t=t.replace(/define\s*&&\s*define\s*\(/gi,"define(module,"),i(t)},module.exports=this}this.config.proxyName&&(Function.prototype[this.config.proxyName]=this.proxy),this.global.define=this.proxy(this,this.define),this.global.oojs=t},fastClone:function(t){var e=function(){};e.prototype=t;var n=new e;return n},proxy:function(){var t=Array.prototype.slice.apply(arguments),e=t.shift(),n="function"==typeof this?this:t.shift();return function(){var i=Array.prototype.slice.apply(arguments);return n.apply(e,i.concat(t))}},create:function(t){var e=Array.prototype.slice.call(arguments,0);e.shift();var n=t.name||"init",i=function(t){this[n]=this[n]||function(){},this[n].apply(this,t)};i.prototype=t;var s=new i(e);for(var r in t){var a=t[r];a&&t.hasOwnProperty(r)&&"object"==typeof a&&(s[r]=this.fastClone(a))}return s.instances=null,s},inherit:function(t,e){t="string"==typeof t?this.using(t):t,e="string"==typeof e?this.using(e):e;for(var n in e)n&&e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])},loadDeps:function(t,e){e=e||{};var n=t.deps,i=!0;for(var s in n)if(s&&n.hasOwnProperty(s)&&n[s]){var r=n[s];if(e&&e[r])continue;e[r]=!0,t[s]=this.find(r),t[s]?t[s].deps&&(i=i&&this.loadDeps(t[s],e)):("node"===this.runtime&&(t[s]=require(this.getClassPath(r))),t[s]||(i=!1))}return i},define:function(t,e){e||(e=t);var n=e.name;e.namespace=e.namespace||"",e.dispose=e.dispose||function(){};for(var i,s=e.namespace.split("."),r=s.length,a=this.global,o=0;r>o;o++)i=s[o],i&&(a[i]=a[i]||{},a=a[i]);if(a[n]=a[n]||{},a[n].name&&a[n].___registered){if(a[n].___registered&&e.classType&&"extend"===e.classType){for(var l in e)l&&e.hasOwnProperty(l)&&(a[n][l]=e[l]);e=a[n]}}else e.___registered=!0,a[n]=e;var h=this.loadDeps(e);if(!h&&"browser"===this.runtime&&this.loadDepsBrowser)this.loadDepsBrowser(e);else{var u="$"+n;e[u]&&e[u]()}return t&&"node"===this.runtime&&(t.exports=e),this},find:function(t){var e,n=t.split(".");e=this.global[n[0]];for(var i=1,s=n.length;s>i;i++){if(!e||!e[n[i]]){e=null;break}e=e[n[i]]}return e},using:function(t){var e=this.find(t);return e||"node"===this.runtime&&(require(this.getClassPath(t)),e=this.find(t)),e},getClassPath:function(t){return this.basePath+t.replace(/\./gi,"/")+".js"}};return t.$oojs(),t.define("undefined"!=typeof module?module:null,t),t}(),define&&define({name:"event",namespace:"oojs",eventList:null,groupList:null,eventGroupIndexer:null,$event:function(){},event:function(){this.eventList={},this.groupList={},this.eventGroupIndexer={}},bind:function(t,e){var n=this.eventList[t]=this.eventList[t]||{};return(n.callbacks=n.callbacks||[]).push(e),n.status=!1,this},removeListener:function(t,e){if(this.eventList[t]){var n=this.eventList[t];if(n.callbacks&&n.callbacks.length)for(var i=0,s=n.callbacks.length;s>i;i++)if(e){if(e===n.callbacks[i]){n.callbacks[i]=null;break}}else n.callbacks[i]=null}},unbind:function(t,e){if(t||e)this.removeListener(t,e);else{var n;for(n in this.eventList)n&&this.eventList[n]&&this.eventList.hasOwnProperty(n)&&this.removeListener(n)}},emit:function(t,e){var n=this.eventList[t];if(n&&n.callbacks&&n.callbacks.length){var i=n.callbacks.length;n.data=[];for(var s=0;i>s;s++){var r=n.callbacks[s];r&&n.data.push(r(e))}n.callbacks=null,n.status=!0}for(var a,o=this.eventGroupIndexer[t]||[],s=0,l=o.length;l>s;s++)a=o[s],a&&this.groupEmit(a)},group:function(t,e,n){this.groupList[t]=this.groupList[t]||{};var i=this.groupList[t],s=i.events=i.events||{};n&&(i.callbacks=i.callbacks||[]).push(n);for(var r,e=e||[],a=0,o=e.length;o>a;a++)r=e[a],s[r]=1,(this.eventGroupIndexer[r]=this.eventGroupIndexer[r]||[]).push(t)},groupEmit:function(t){var e=this.groupList[t];if(e){var n,i,s=e.events=e.events||{},r=!0,a={};for(n in s)if(n&&s.hasOwnProperty(n)){if(i=this.eventList[n],!i||!i.status){r=!1,a=null;break}a[n]=i.data}if(n=null,r){e.callbacks=e.callbacks||[];for(var o,l=e.callbacks,h=l.length||0,u=0;h>u;u++)o=e.callbacks[u],o&&(o(a),e.callbacks[u]=null);o=null,e.callbacks=null;for(var c,f=e.afters=e.afters||[],h=f.length||0,u=0;h>u;u++)c=f[u],c&&(c(a),f[u]=null);c=null,e.afters=null}}},afterGroup:function(t,e){var n=this.groupList[t]=this.groupList[t]||{},i=n.afters=n.afters||[];i.push(e)}}),define&&define({name:"oojs",namespace:"",classType:"extend",$oojs:function(){this.ev=oojs.create(oojs.event)},isNullObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},loadScript:function(t,e,n){if("function"==typeof e&&(n=e,e="1.0.0"),e=e||"1.0.0",t.indexOf("http")<0&&(t=this.basePath+t.replace(/\./g,"/")+".js"),e&&(t+="?v="+e),n=n||function(){},this.ev.bind(t,function(t,e){e&&e()}.proxy(this,n)),this.loading=this.loading||{},!this.loading[t]){this.loading[t]=1;var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onerror=i.onreadystatechange=function(t,e,n){"string"==typeof t&&(e=t,n=e),/loaded|complete|undefined/.test(n.readyState)&&(n.onload=n.onerror=n.onreadystatechange=null,n=void 0,this.ev.emit(e,1))}.proxy(this,t,i);var s=document.getElementsByTagName("script")[0];return s.parentNode.insertBefore(i,s),this}},loadDepsBrowser:function(t){var e=t.deps,n="$"+t.name;if(this.isNullObj(e))t[n]&&t[n]();else for(var i in e)if(i&&e.hasOwnProperty(i)){var s=e[i],r=this.using(s);if(r){t[i]=r;continue}this.ev.bind(s,function(t,e){return oojs.using(e)}.proxy(this,s)),this.ev.group("loadDeps",[s],function(t,e,n,i){i[e]=t[n][0]}.proxy(this,i,s,t)),this.ev.afterGroup("loadDeps",function(){var e="$"+t.name;t[e]&&t[e]()}.proxy(this,t));var a=this.basePath+s.replace(/\./gi,"/")+".js",o=function(t){this.ev.emit(t)}.proxy(this,s);this.loadScript(a,o)}return this}});