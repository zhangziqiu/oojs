!function(){var t={name:"oojs",namespace:"",config:{global:!1,proxyName:"proxy",basePath:""},$oojs:function(){if(this.config="undefined"!=typeof $oojs_config?$oojs_config:this.config,"undefined"!=typeof window)this.global=this.config.global||window,this.runtime="browser",this.basePath=this.config.basePath;else if(global){var e=require("path");this.global=this.config.global||global,this.runtime="node",this.basePath=this.config.basePath?e.resolve(this.config.basePath):e.resolve(__dirname,"../../../src")+"/";var i=module.constructor,n=i.wrap;i.wrap=function(t){return t=t.replace(/define\s*&&\s*define\s*\(/gi,"define(module,"),n(t)},module.exports=this}this.config.proxyName&&(Function.prototype[this.config.proxyName]=this.proxy),this.global.define=this.proxy(this,this.define),this.global.oojs=t},fastClone:function(t){var e=function(){};e.prototype=t;var i=new e;return i},proxy:function(){var t=Array.prototype.slice.apply(arguments),e=t.shift(),i="function"==typeof this?this:t.shift();return function(){var n=Array.prototype.slice.apply(arguments);return i.apply(e,n.concat(t))}},create:function(t){var e=Array.prototype.slice.call(arguments,0);e.shift();var i=t.name||"init",n=function(t){this[i]=this[i]||function(){},this[i].apply(this,t)};n.prototype=t;var s=new n(e);for(var r in t){var a=t[r];a&&t.hasOwnProperty(r)&&"object"==typeof a&&(s[r]=this.fastClone(a))}return s.instances=null,s},inherit:function(t,e){t="string"==typeof t?this.using(t):t,e="string"==typeof e?this.using(e):e;for(var i in e)i&&e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i])},loadDeps:function(t,e){e=e||{};var i=t.deps,n=!0;for(var s in i)if(s&&i.hasOwnProperty(s)&&i[s]){var r=i[s];if(t[s]=this.find(r),e&&e[r])continue;if(e[r]=!0,t[s])t[s].deps&&(n=n&&this.loadDeps(t[s],e));else{if("node"===this.runtime)try{t[s]=require(this.getClassPath(r))}catch(a){}t[s]||(n=!1)}}return n},define:function(t,e){e||(e=t);var i=e.name;e.namespace=e.namespace||"",e.dispose=e.dispose||function(){};for(var n,s=e.namespace.split("."),r=s.length,a=this.global,o=0;r>o;o++)n=s[o],n&&(a[n]=a[n]||{},a=a[n]);if(a[i]=a[i]||{},a[i].name&&a[i].___registered){if(a[i].___registered&&e.classType&&"extend"===e.classType){for(var l in e)l&&e.hasOwnProperty(l)&&(a[i][l]=e[l]);e=a[i]}}else e.___registered=!0,a[i]=e;var h=this.loadDeps(e);if(!h&&"browser"===this.runtime&&this.loadDepsBrowser)this.loadDepsBrowser(e);else{var c="$"+i;e[c]&&e[c]()}return t&&"node"===this.runtime&&(t.exports=e),this},find:function(t){var e,i=t.split(".");e=this.global[i[0]];for(var n=1,s=i.length;s>n;n++){if(!e||!e[i[n]]){e=null;break}e=e[i[n]]}return e},using:function(t){var e=this.find(t);return e||"node"===this.runtime&&(require(this.getClassPath(t)),e=this.find(t)),e},getClassPath:function(t){return this.basePath+t.replace(/\./gi,"/")+".js"}};return t.$oojs(),t.define("undefined"!=typeof module?module:null,t),t}(),define&&define({name:"event",namespace:"oojs",eventList:null,groupList:null,eventGroupIndexer:null,$event:function(){},event:function(){this.eventList={},this.groupList={},this.eventGroupIndexer={}},bind:function(t,e){var i=this.eventList[t]=this.eventList[t]||{};return(i.callbacks=i.callbacks||[]).push(e),i.status=!1,this},removeListener:function(t,e){if(this.eventList[t]){var i=this.eventList[t];if(i.callbacks&&i.callbacks.length)for(var n=0,s=i.callbacks.length;s>n;n++)if(e){if(e===i.callbacks[n]){i.callbacks[n]=null;break}}else i.callbacks[n]=null}},unbind:function(t,e){if(t||e)this.removeListener(t,e);else{var i;for(i in this.eventList)i&&this.eventList[i]&&this.eventList.hasOwnProperty(i)&&this.removeListener(i)}},emit:function(t,e){var i=this.eventList[t];if(i&&i.callbacks&&i.callbacks.length){var n=i.callbacks.length;i.data=[];for(var s=0;n>s;s++){var r=i.callbacks[s];r&&i.data.push(r(e))}i.callbacks=null,i.status=!0}for(var a,o=this.eventGroupIndexer[t]||[],s=0,l=o.length;l>s;s++)a=o[s],a&&this.groupEmit(a)},group:function(t,e,i){this.groupList[t]=this.groupList[t]||{};var n=this.groupList[t],s=n.events=n.events||{};i&&(n.callbacks=n.callbacks||[]).push(i);for(var r,e=e||[],a=0,o=e.length;o>a;a++)r=e[a],s[r]=1,(this.eventGroupIndexer[r]=this.eventGroupIndexer[r]||[]).push(t)},groupEmit:function(t){var e=this.groupList[t];if(e){var i,n,s=e.events=e.events||{},r=!0,a={};for(i in s)if(i&&s.hasOwnProperty(i)){if(n=this.eventList[i],!n||!n.status){r=!1,a=null;break}a[i]=n.data}if(i=null,r){e.callbacks=e.callbacks||[];for(var o,l=e.callbacks,h=l.length||0,c=0;h>c;c++)o=e.callbacks[c],o&&(o(a),e.callbacks[c]=null);o=null,e.callbacks=null;for(var u,f=e.afters=e.afters||[],h=f.length||0,c=0;h>c;c++)u=f[c],u&&(u(a),f[c]=null);u=null,e.afters=null}}},afterGroup:function(t,e){var i=this.groupList[t]=this.groupList[t]||{},n=i.afters=i.afters||[];n.push(e)}}),define&&define({name:"oojs",namespace:"",classType:"extend",$oojs:function(){this.ev=oojs.create(oojs.event)},isNullObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},loadScript:function(t,e,i){if("function"==typeof e&&(i=e,e="1.0.0"),e=e||"1.0.0",t.indexOf("http")<0&&(t=this.basePath+t.replace(/\./g,"/")+".js"),e&&(t+="?v="+e),i=i||function(){},this.ev.bind(t,function(t,e){e&&e()}.proxy(this,i)),this.loading=this.loading||{},!this.loading[t]){this.loading[t]=1;var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onerror=n.onreadystatechange=function(t,e,i){"string"==typeof t&&(e=t,i=e),/loaded|complete|undefined/.test(i.readyState)&&(i.onload=i.onerror=i.onreadystatechange=null,i=void 0,this.ev.emit(e,1))}.proxy(this,t,n);var s=document.getElementsByTagName("script")[0];return s.parentNode.insertBefore(n,s),this}},loadDepsBrowser:function(t){var e=t.deps,i="$"+t.name;if(this.isNullObj(e))t[i]&&t[i]();else for(var n in e)if(n&&e.hasOwnProperty(n)){var s=e[n],r=this.using(s);if(r){t[n]=r;continue}this.ev.bind(s,function(t,e){return oojs.using(e)}.proxy(this,s)),this.ev.group("loadDeps",[s],function(t,e,i,n){n[e]=t[i][0]}.proxy(this,n,s,t)),this.ev.afterGroup("loadDeps",function(){var e="$"+t.name;t[e]&&t[e]()}.proxy(this,t));var a=this.basePath+s.replace(/\./gi,"/")+".js",o=function(t){this.ev.emit(t)}.proxy(this,s);this.loadScript(a,o)}return this}});